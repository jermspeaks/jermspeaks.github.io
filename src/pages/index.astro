---
import { getCollection } from "astro:content";
import { SITE_TITLE, SITE_DESCRIPTION } from "../consts";
import BaseBody from "../components/BaseBody.astro";
import BaseHead from "../components/BaseHead.astro";
import Footer from "../components/Footer.astro";
import FormattedDate from "../components/FormattedDate.astro";
import Header from "../components/Header.astro";

const series = (await getCollection("series")).sort(
  (a, b) => b.data.createdDate.valueOf() - a.data.createdDate.valueOf()
);
const lastPost = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())[0];
const lastProject = (await getCollection("project")).sort(
  (a, b) => b.data.createdDate.valueOf() - a.data.createdDate.valueOf()
)[0];
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>

  <BaseBody>
    <Header title={SITE_TITLE} />
    <main>
      <h1 class="mt-12 mb-6 text-6xl">
        <strong>Jeremy</strong> makes essays and mini projects about programming,
        data, and crafting.
      </h1>
      <h2 class="mb-2 text-2xl font-thin">
        Developer, former Biomedical engineering, and home cook
      </h2>
      <h2 class="mb-5 text-2xl font-thin">
        Currently leading application development at <a
          class="text-orange-500 hover:text-orange-300"
          href="https://clearlabs.com/"
          target="_blank">Clear Labs</a
        >
      </h2>

      <hr class="mt-10 mb-10" />

      <article class="prose lg:prose-xl">
        <h2>Newsletter Series</h2>

        <p>
          A weekly, longform essay that mainly focuses on lessons I've learned.
          I try to write something I find meaningful, whether it's exposing your
          ignorance, staying true to yourself or being resilient. In a world of
          tweet-sized advice and short comments on a non-sensical Facebook post,
          there's not enough time to process and distill what we're actually
          thinking. These letters are to slow down, lean in and really try to
          form more coherent thoughts than writing that instant gratification
          post on my choice of social networking site.
        </p>

        <section>
          <ul class="pl-0 flex flex-col gap-12 list-none">
            {
              series.map((s) => (
                <li class="flex flex-col md:flex-row">
                  <div class="flex flex-col flex-auto md:flex-grow-0 md:flex-shrink-0 md:flex-[350px]">
                    <a href={`/series/${s.slug}/`}>{s.data.title}</a>
                    <div class="flex-auto italic text-slate-600">
                      <FormattedDate date={s.data.createdDate} />
                      &nbsp;to&nbsp;
                      <FormattedDate date={s.data.endDate} />
                    </div>
                    {s.data.heroImage && (
                      <img width={240} src={s.data.heroImage} alt="" />
                    )}
                  </div>
                  <div>{s.data.description}</div>
                </li>
              ))
            }
          </ul>
        </section>
      </article>

      <article class="flex justify-start gap-5 mt-2 mb-2">
        <div>
          <h2 class="text-2xl">Latest Post</h2>
          <li>
            <FormattedDate date={lastPost.data.pubDate} />
            <a href={`/blog/${lastPost.slug}/`}>{lastPost.data.title}</a>
          </li>
        </div>
        <div>
          <h2 class="text-2xl">Latest Project</h2>
          <li>
            <FormattedDate date={lastProject.data.createdDate} />
            <a href={`/project/${lastProject.slug}/`}
              >{lastProject.data.title}</a
            >
          </li>
        </div>
      </article>

      <hr class="mt-5 mb-5" />

      <article class="prose lg:prose-xl">
        <form
          action="https://tinyletter.com/jeremywong"
          class="landing-newsletter-form"
          method="post"
          onsubmit="window.open('https://tinyletter.com/jeremywong', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true"
          target="popupwindow"
        >
          <div>
            <label for="tlemail">
              Subscribe to my newsletter! I write longform essays that mainly
              focuses on lessons I've learned.
            </label>
          </div>
          <div class="flex gap-4">
            <div>
              <input
                type="text"
                name="email"
                id="tlemail"
                class="py-2 px-4"
                placeholder="email address"
              />
              <input type="hidden" value="1" name="embed" />
            </div>
            <div>
              <input class="sr-only" type="hidden" value="Subscribe" />
              <button
                class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded"
                type="submit">Subscribe</button
              >
            </div>
          </div>
          <p class="text-sm">
            <a href="https://tinyletter.com" target="_blank"
              >powered by TinyLetter</a
            >
          </p>
        </form>
      </article>
    </main>

    <Footer />
  </BaseBody>
</html>
